\documentclass[a4paper, 12pts]{article}
\usepackage{graphicx, amsmath, amsfonts, amssymb, verbatim}

\title{\bf SNM-GARCH: A Semi-Parametric Mixture Model to Account for Black
Swans}
\author{\em Cheng-Jan Kao \\ ID: 3910587}
\date{}

\begin{document}
\maketitle


\section{logd.mgarch}
\label{sec:logd.mgarch}

\subsection{log density}

\begin{align*}
  f(\mathbf{x}; \theta_i, \sigma_t) &= \frac{1}{\sqrt{2 \pi \theta_i^2
      \sigma_t^2}} \exp \left( -\frac{x^2}{2 \theta_i^2 \sigma_t^2}
  \right)\\
  l(\mathbf{x}; \theta_i, \sigma_t) = \log f(\mathbf{x}; \theta_i,
  \sigma_t) &= -\frac{1}{2}\log 2 \pi - \log{\theta_i} -
  \log{\sigma_t} - \frac{x_t^2}{2\theta_i^2 \sigma_t^2}\\
  \frac{\partial l}{\partial \sigma_t} &= \left( -\frac{1}{\sigma_t} +
    \frac{x_t^2}{\theta_i^2 \sigma_t^3}\right)\\
\end{align*}

where
\begin{align*}
  \sigma_t^2 &= \alpha_0 + \alpha_1 \sigma_{t-1}^2 + \beta_1
  \sigma_{t-1}^2\\
  &= \alpha_0 \sum_{i = 0}^{t - 2} \alpha_1^i + \alpha_1^{t - 1}
  \sigma_1^2 + \beta_1 \sum_{j = 0}^{t - 2} \alpha_1^j x_{t - j - 1}
  \quad
  \text{for} \, \, t \ge 2\\
  \sigma_t &= \left(\alpha_0 \sum_{i = 0}^{t - 2} \alpha_1^i +
    \alpha_1^{t - 1} \sigma_1^2 + \beta_1 \sum_{j = 0}^{t - 2} \alpha_1^j
    x_{t - j - 1}\right)^{1/2}
\end{align*}

Then

\begin{align*}
  \frac{\partial\sigma_t}{\partial\alpha_0} &=
  \frac{1}{2\sigma_t}\left( \sum_{i = 0}^{t-2} \alpha_1^i \right)\\
  \frac{\partial \sigma_t}{\partial \alpha_1} &= \frac{1}{2\sigma_t}
  \left( \alpha_0 \sum_{i = 1}^{t - 2} i\alpha_1^{i -1} + (t -
    1)\alpha_1^{t - 2} \sigma_1^2 +
    \beta_1 \sum_{j = 1}^{t - 2} j \alpha_1^{j - 1} x_{t - j - 1}\right)\\
  \frac{\partial \sigma_t}{\partial \beta_1} &=
  \frac{1}{2\sigma_t} \left(\sum_{j = 0}^{t - 2}
  \alpha_1^j x_{t - j - 1} \right)\\
  \frac{\partial \sigma_t}{\partial \sigma_1} &=
  \frac{1}{2\sigma_t}\left(2\alpha_1^{t-1}\sigma_1\right)\\
\end{align*}


\subsection{Partial Beta}

\begin{align*}
  \frac{\partial{l}}{\partial{\alpha_0}} &=
  \frac{\partial{l}}{\partial{\sigma}} \times
  \frac{\partial{\sigma}}{\partial{\alpha_0}}\\
  &= \left(\sum_{t = 1}^T \sum_{i = 1}^M -\frac{1}{\sigma_t} +
    \frac{x_t^2}{\theta_i^2 \sigma_t^3}\right) \times
  \frac{1}{2\sigma_t}\left( \sum_{i = 0}^{t-2} \alpha_1^i \right)\\
  \frac{\partial{l}}{\partial{\alpha_1}} &=
  \frac{\partial{l}}{\partial{\sigma}} \times
  \frac{\partial{\sigma}}{\partial{\alpha_1}}\\
  &= \left(\sum_{t = 1}^T \sum_{i = 1}^M -\frac{1}{\sigma_t} +
    \frac{x_t^2}{\theta_i^2 \sigma_t^3}\right) \times
  \frac{1}{2\sigma_t} \left( \alpha_0 \sum_{i = 1}^{t - 2}
    i\alpha_1^{i -1} + (t - 1)\alpha_1^{t - 2} \sigma_1^2 + \beta_1
    \sum_{j = 1}^{t - 2} j \alpha_1^{j - 1} x_{t - j - 1}\right)\\
  \frac{\partial l}{\partial \beta_1} &= \frac{\partial l}{\partial
    \sigma} \times \frac{\partial \sigma}{\partial \beta_1}\\
  &= \left(\sum_{t = 1}^T \sum_{i = 1}^M -\frac{1}{\sigma_t} +
    \frac{x_t^2}{\theta_i^2 \sigma_t^3}\right)\times
  \frac{1}{2\sigma_t} \left(\sum_{j = 0}^{t - 2}
    \alpha_1^j x_{t - j - 1} \right)\\
  \frac{\partial l}{\partial \sigma_1} &= \frac{\partial l}{\partial
    \sigma} \times \frac{\partial \sigma}{\partial \sigma_1}\\
    &= \left(\sum_{t = 1}^T \sum_{i = 1}^M -\frac{1}{\sigma_t} +
      \frac{x_t^2}{\theta_i^2 \sigma_t^3}\right) \times
    \frac{\alpha^{t
        - 1}\sigma_1}{\sigma_t}\\
\end{align*}

\subsection{Partial Theta}

\begin{align*}
\frac{\partial l}{\partial \boldsymbol{\theta}} &= \sum_{t = 1}^T \sum_{i = 1}^M
-\frac{1}{\theta_i} + \frac{x_t^2}{\theta_i^3 \sigma_t^2}\\
\frac{\partial^2 l}{\partial \boldsymbol{\theta}^2} &= \sum_{t = 1}^T \sum_{i = 1}^M
\frac{1}{\theta_i^2} - \frac{3x_t^2}{\theta_i^4 \sigma_t^2}
\end{align*}



\section{Improvements and Further actions}
\begin{enumerate}
  \item (1) Get the model (With scaling) CORRECT!!!!!!!
  \item Might remove beta[4], as it doesn't make much sense to
    estimate that.
  \item Include skewness, and mean estimation (This might be very
    interesting and useful as we have see that commodity skews
    different direction to the normal commodities). The skewness seems
    slightly difficult to implement as it may not have analytical
    solution, will have a look at the implementation in the fGarch
    package.
  \item survey all the GARCH/financial package.
  \item Work on all sorts of financial data.
  \item Get Matthieu and others at FAO to review it.
  \item Improve the efficiency of the logd.mgarch function.
  \item Test the difference between real data and simulated data.
  \item Have a look at the FAO book and talk to Matthieu about how the
    model can work. How would I assess the model other than using
    likelihood/information criteria based method? (e.g. prediction)
\end{enumerate}

\end{document}
