########################################################################
## Example data. This is a commodity return, but can't remember what it
## is now.
########################################################################
rii <- c(395, 399, 415, 419, 433, 442, 442, 442, 442, 442, 463, 470,
         470, 480, 505, 515, 519, 535, 523, 498, 487, 455, 428, 379,
         343, 324, 325, 312.5, 299, 292, 290, 287, 270, 254, 258, 266,
         260, 270, 282, 282, 280, 269, 260, 275, 298, 290, 283, 273,
         257, 253, 253, 256, 253, 256, 273, 272, 252, 250, 228, 224,
         225, 220, 221, 222, 223, 223, 210, 210, 210, 210, 210, 225,
         240, 230, 216, 202, 200, 204, 181, 186, 173, 175, 174, 167,
         173, 187, 198, 199, 198, 196, 191, 204, 250, 267, 254, 256,
         292, 306, 294, 288, 257, 269, 274, 269, 273, 273, 272, 260,
         264, 271, 277, 293, 311, 331, 351, 332, 321, 304, 270, 272,
         276, 300, 289, 276, 260, 255, 256, 260, 259, 281, 272, 264,
         305, 326, 311, 286, 288, 293, 306, 298, 290, 277, 274, 270,
         276, 278, 277, 279, 274, 266, 279, 269, 256, 250, 252, 256,
         262, 254, 230, 206, 185, 189, 210, 210, 206, 257, 323, 315,
         354, 363, 274, 269, 235, 216, 226, 250, 259.75, 261.75, 264.5,
         260.5, 274.75, 286.25, 283, 281.5, 287.75, 326, 345.6, 340.67,
         359.75, 382.6, 340.5, 341.25, 364.4, 367, 362.5, 325.8, 332.25,
         341.5, 358, 335.5, 328.4, 312.75, 315, 313.67, 356, 347, 323.4,
         299.33, 324.5, 323.2, 320, 285, 270.2, 265.75, 251.75, 263.5,
         293.5, 297, 295, 311, 318.5, 331, 323, 323, 322, 298.25,
         270.33, 282.5, 301.67, 280, 256.2, 235.5, 244.25, 254.75,
         255.75, 251, 233, 217, 227.5, 231, 247.5, 243, 228.8, 217,
         198.78, 197.86, 191, 187.09, 178.14, 186.73, 184.86, 183.57,
         184.43, 185.1, 177.09, 162.1, 164.26, 167.76, 169.73, 168.74,
         173, 170.87, 170, 179.38, 191.13, 194.35, 189.29, 189.5, 198.3,
         202, 199.61, 191.32, 188.48, 185.48, 187.19, 185.27, 199.74,
         198.75, 196.95, 195.18, 197.73, 203.67, 199.48, 196.43, 202.86,
         204, 201.75, 197, 207.45, 213.25, 240.35, 253.41, 251.57,
         244.23, 240.32, 252.55, 252, 253.52, 262.32, 278.43, 288.38,
         292.35, 295, 299.14, 295.27, 287.05, 278.71, 283.48, 287.41,
         290.71, 278.95, 277.27, 284.45, 296.4, 297.74, 298.5, 301.26,
         305.59, 312.43, 313.39, 312.9, 309.64, 300.59, 309.29, 313.48,
         316.05, 326.18, 322.29, 320.61, 326.29, 332.55, 331.48, 330,
         335.3, 356.5, 378, 393.48, 481.14, 672.64, 1015.21, 1009.32,
         834.6, 799, 737, 722, 624, 563.25, 550.75, 615.25, 634, 625.25,
         577.25, 540.75, 548.6, 623, 576.25, 593.67, 566.25, 566.25,
         606, 598, 584.75, 540.13, 502.23, 472.48, 458.55, 470.68,
         486.86, 519.95, 533.13, 543.14, 536.78, 528.38, 532.8, 508.96,
         500.57, 500.55, 518.09, 546.19, 577.3, 615.55, 602.14, 609.09,
         580.91)

## Take the log return and model
rii <- diff(log(rii))
trii <- rii
class(trii) <- "mgarch"
rii.t0 <- garchFit(data = rii, cond.dist = "snorm", include.mean = FALSE)
rii.t1 <- garchFit(data = rii, cond.dist = "sged", include.mean = FALSE)
rii.t2 <- garchFit(data = rii, cond.dist = "sstd", include.mean = FALSE)
(rii.mg <- cnmms(trii, plot = "gradient", grid = 300, verb = 4))

## The log likelihoods and summary
rii.t0@fit$llh
rii.t1@fit$llh
rii.t2@fit$llh
summary(rii.mg)


## This is the S&P data which has very large gradient
library(tseries)
sp <- get.hist.quote("SPY", quote = "Open",
                     end = "2006-01-02",
                     start = "2002-12-30",
                     provider = "yahoo")


tsp <- diff(log(as.numeric(sp)))[1:300]
tmsp <- tsp
class(tmsp) <- "mgarch"
sp.t0 <- garchFit(data = tsp, cond.dist = "snorm", include.mean = FALSE)
sp.t1 <- garchFit(data = tsp, cond.dist = "sged", include.mean = FALSE)
sp.t2 <- garchFit(data = tsp, cond.dist = "sstd", include.mean = FALSE)
(sp.mg <- cnmms(tmsp, plot = "gradient", grid = 1000, verb = 4))
